 <!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lalatina</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #0f172a;
  color: #e5e7eb;
}

.container {
  max-width: 420px;
  margin: auto;
  padding: 20px;
}

.card {
  background: #020617;
  border-radius: 14px;
  padding: 20px;
  box-shadow: 0 0 20px rgba(0,0,0,.4);
}

h1, h2 {
  text-align: center;
}

button {
  width: 100%;
  padding: 14px;
  margin-top: 12px;
  border-radius: 10px;
  border: none;
  background: #2563eb;
  color: #fff;
  font-size: 16px;
  cursor: pointer;
}

button:hover {
  background: #1d4ed8;
}

.option {
  background: #020617;
  border: 1px solid #334155;
  padding: 12px;
  border-radius: 10px;
  margin-top: 10px;
  cursor: pointer;
}

.option:hover {
  background: #1e293b;
}

.progress {
  margin-top: 10px;
  font-size: 14px;
  opacity: .7;
}

.explanation {
  background: #020617;
  border-left: 4px solid #22c55e;
  padding: 12px;
  margin-top: 12px;
  font-size: 14px;
}
</style>
</head>

<body>
<div class="container">
  <div class="card" id="app"></div>
</div>

<script>
const app = document.getElementById("app");

let state = JSON.parse(localStorage.getItem("lalatina")) || {
  phase: 1,
  mode: "study", // study | training | exam
  index: 0,
  correct: 0,
  totalAnswered: 0
};

const PHASE_RULES = {
  minExamCorrect: 16,
  unlockExamAfter: 20
};

const phases = {
  1: {
    name: "Verbo To Be",
    explanation: `
O verbo <b>to be</b> significa <b>ser</b> ou <b>estar</b>.<br><br>
I am (eu sou/estou)<br>
You are (você é/está)<br>
He / She / It is<br>
We are<br>
They are
    `,
    questions: [
      { q: "I ___ happy.", a: "am", o: ["am","is","are"] },
      { q: "She ___ a teacher.", a: "is", o: ["am","is","are"] },
      { q: "They ___ friends.", a: "are", o: ["am","is","are"] },
      { q: "He ___ tired.", a: "is", o: ["am","is","are"] },
      { q: "We ___ ready.", a: "are", o: ["am","is","are"] },
      { q: "You ___ correct.", a: "are", o: ["am","is","are"] },
      { q: "It ___ cold.", a: "is", o: ["am","is","are"] },
      { q: "I ___ late.", a: "am", o: ["am","is","are"] }
    ]
  }
};

function save() {
  localStorage.setItem("lalatina", JSON.stringify(state));
}

function shuffle(arr) {
  return arr.sort(() => Math.random() - 0.5);
}

function render() {
  const phase = phases[state.phase];
  const questions = shuffle([...phase.questions]);
  const q = questions[state.index % questions.length];

  if (state.mode === "study") {
    app.innerHTML = `
      <h2>${phase.name}</h2>
      <div class="explanation">${phase.explanation}</div>
      <button onclick="startTraining()">Começar Treino</button>
    `;
    return;
  }

  if (state.mode === "exam") {
    app.innerHTML = `
      <h2>Prova</h2>
      <p>${q.q}</p>
      ${q.o.map(op => `
        <div class="option" onclick="answer('${op}','${q.a}')">${op}</div>
      `).join("")}
      <div class="progress">
        Acertos: ${state.correct} / ${PHASE_RULES.minExamCorrect}
      </div>
    `;
    return;
  }

  app.innerHTML = `
    <h2>${phase.name}</h2>
    <p>${q.q}</p>
    ${q.o.map(op => `
      <div class="option" onclick="answer('${op}','${q.a}')">${op}</div>
    `).join("")}
    <div class="progress">
      Respondidas: ${state.totalAnswered}
    </div>
  `;
}

function answer(selected, correct) {
  state.totalAnswered++;
  if (selected === correct) state.correct++;

  state.index++;

  if (
    state.mode === "training" &&
    state.totalAnswered >= PHASE_RULES.unlockExamAfter
  ) {
    state.mode = "exam";
    state.correct = 0;
  }

  if (
    state.mode === "exam" &&
    state.correct >= PHASE_RULES.minExamCorrect
  ) {
    alert("Parabéns! Você passou de fase!");
    state.phase++;
    state.mode = "study";
    state.index = 0;
    state.correct = 0;
    state.totalAnswered = 0;
  }

  save();
  render();
}

function startTraining() {
  state.mode = "training";
  save();
  render();
}

render();
</script>
</body>
</html>
