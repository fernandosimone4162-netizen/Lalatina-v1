
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>La Latina</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #0f172a;
  color: #e5e7eb;
}
.container {
  max-width: 420px;
  margin: auto;
  padding: 20px;
}
.card {
  background: #020617;
  border-radius: 14px;
  padding: 20px;
}
h2 { text-align: center; }
.option {
  border: 1px solid #334155;
  padding: 14px;
  border-radius: 10px;
  margin-top: 10px;
}
.option:active { background: #1e293b; }
button {
  width: 100%;
  padding: 14px;
  margin-top: 14px;
  border-radius: 10px;
  border: none;
  background: #2563eb;
  color: white;
  font-size: 16px;
}
.feedback {
  margin-top: 10px;
  font-size: 14px;
  opacity: .85;
}
</style>
</head>

<body>
<div class="container">
  <div class="card" id="app"></div>
</div>

<script>
const app = document.getElementById("app");

let state = JSON.parse(localStorage.getItem("lalatina")) || {
  phase: 1,
  correct: 0,
  errors: 0,
  index: 0
};

function save() {
  localStorage.setItem("lalatina", JSON.stringify(state));
}

/* ðŸ”Š Voz */
function speak(text) {
  const u = new SpeechSynthesisUtterance(text);
  u.lang = "en-US";
  u.rate = 0.9;
  speechSynthesis.speak(u);
}

/* ðŸ“ˆ ProgressÃ£o */
function getLevel() {
  if (state.correct < 75) return 1;
  if (state.correct < 150) return 2;
  if (state.correct < 225) return 3;
  return 4;
}

/* ðŸ“š Banco eficiente */
const subjects = [
  { en: "I", pt: "Eu", v: "am", neg: "am not" },
  { en: "You", pt: "VocÃª", v: "are", neg: "are not" },
  { en: "He", pt: "Ele", v: "is", neg: "is not" },
  { en: "She", pt: "Ela", v: "is", neg: "is not" },
  { en: "We", pt: "NÃ³s", v: "are", neg: "are not" },
  { en: "They", pt: "Eles", v: "are", neg: "are not" }
];

const complementsByLevel = {
  1: [
    { en: "happy", pt: "feliz" },
    { en: "ready", pt: "pronto" }
  ],
  2: [
    { en: "very happy", pt: "muito feliz" },
    { en: "at home", pt: "em casa" }
  ],
  3: [
    { en: "very tired today", pt: "muito cansado hoje" },
    { en: "at home now", pt: "em casa agora" }
  ],
  4: [
    { en: "very tired today at home", pt: "muito cansado hoje em casa" },
    { en: "not very comfortable now", pt: "nÃ£o muito confortÃ¡vel agora" }
  ]
};

function generateQuestion() {
  const level = getLevel();
  const s = subjects[state.index % subjects.length];
  const comps = complementsByLevel[level];
  const c = comps[Math.floor(state.index / subjects.length) % comps.length];

  if (state.phase === 1) {
    return {
      text: `${s.en} ___ ${c.en}`,
      correct: s.v,
      full: `${s.en} ${s.v} ${c.en}`,
      translation: `${s.pt} ${c.pt}`
    };
  } else {
    return {
      text: `${s.en} ___ ${c.en}`,
      correct: s.neg,
      full: `${s.en} ${s.neg} ${c.en}`,
      translation: `${s.pt} nÃ£o ${c.pt}`
    };
  }
}

/* ðŸ–¥ï¸ Telas */
function renderIntro() {
  app.innerHTML = `
    <h2>Fase ${state.phase}</h2>
    <p>
      ${state.phase === 1
        ? "O verbo <b>to be</b> significa ser ou estar."
        : "Agora vamos aprender a forma negativa do verbo to be."}
    </p>
    <button onclick="start()">ComeÃ§ar</button>
  `;
}

function renderQuestion() {
  const q = generateQuestion();
  app.innerHTML = `
    <h2>${q.text}</h2>
    ${shuffle(["am","is","are","am not","is not","are not"]).map(o =>
      `<div class="option" onclick="answer('${o}')">${o}</div>`
    ).join("")}
    <div class="feedback" id="feedback"></div>
    <div class="feedback">Acertos: ${state.correct}/300</div>
  `;
}

function renderSuccess() {
  app.innerHTML = `
    <h2>ðŸŽ‰ ParabÃ©ns!</h2>
    <p>VocÃª concluiu a Fase ${state.phase}</p>
    <button onclick="nextPhase()">PrÃ³xima fase</button>
  `;
}

/* âš™ï¸ LÃ³gica */
function answer(selected) {
  const q = generateQuestion();
  const feedback = document.getElementById("feedback");

  if (selected === q.correct) {
    state.correct++;
    state.errors = 0;
    speak(q.full);
    state.index++;
  } else {
    state.errors++;
    feedback.innerText = "âŒ Errado";
    if (state.errors >= 3) {
      feedback.innerText += `\n${q.translation}`;
    }
  }

  if (state.correct >= 300) {
    save();
    renderSuccess();
    return;
  }

  save();
  setTimeout(renderQuestion, 800);
}

function start() {
  state.correct = 0;
  state.errors = 0;
  state.index = 0;
  save();
  renderQuestion();
}

function nextPhase() {
  state.phase++;
  state.correct = 0;
  state.errors = 0;
  state.index = 0;
  save();
  renderIntro();
}

function shuffle(arr) {
  return arr.sort(() => Math.random() - 0.5);
}

/* ðŸš€ Start */
renderIntro();
</script>
</body>
</html>
