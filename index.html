
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lalatina</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #0f172a;
  color: #fff;
}

.screen {
  display: none;
  padding: 20px;
}

.screen.active {
  display: block;
}

h1, h2 {
  text-align: center;
}

button {
  width: 100%;
  padding: 16px;
  margin-top: 14px;
  font-size: 18px;
  border: none;
  border-radius: 12px;
  background: #2563eb;
  color: #fff;
}

button:active {
  background: #1e40af;
}

input {
  width: 100%;
  padding: 16px;
  font-size: 18px;
  border-radius: 12px;
  border: none;
  margin-top: 14px;
}

.feedback {
  margin-top: 14px;
  text-align: center;
}

.hidden {
  display: none;
}
</style>
</head>

<body>

<!-- HOME -->
<div class="screen active" id="home">
  <h1>Lalatina</h1>
  <p style="text-align:center">Aprenda idiomas ouvindo primeiro.</p>
  <button onclick="start()">ComeÃ§ar</button>
</div>

<!-- FASE 1 -->
<div class="screen" id="phase">
  <h2>Fase 1</h2>

  <div id="questionText" class="hidden"></div>

  <button onclick="playAudio()">ðŸ”Š Ouvir pergunta</button>

  <input id="answer" placeholder="Digite a traduÃ§Ã£o">
  <button onclick="submit()">Responder</button>

  <div class="feedback" id="feedback"></div>
</div>

<!-- PROVA -->
<div class="screen" id="exam">
  <h2>Prova</h2>
  <p id="examQuestion"></p>
  <input id="examAnswer" placeholder="TraduÃ§Ã£o">
  <button onclick="sendExam()">Enviar</button>
  <div class="feedback" id="examFeedback"></div>
</div>

<!-- RESULTADO -->
<div class="screen" id="result">
  <h2 id="resultTitle"></h2>
  <p id="resultText"></p>
</div>

<script>
const questions = [
  { en: "Good morning", pt: ["bom dia"] },
  { en: "How are you", pt: ["como vocÃª estÃ¡", "como vai vocÃª"] },
  { en: "Thank you", pt: ["obrigado", "obrigada"] }
];

let qIndex = 0;
let attempts = 0;
let hits = 0;

function start() {
  show("phase");
  loadQuestion();
}

function loadQuestion() {
  attempts = 0;
  document.getElementById("questionText").classList.add("hidden");
  document.getElementById("questionText").innerText =
    "Traduza: " + questions[qIndex].en;
  document.getElementById("feedback").innerText = "";
  document.getElementById("answer").value = "";
}

function playAudio() {
  const speech = new SpeechSynthesisUtterance(questions[qIndex].en);
  speech.lang = "en-US";
  speechSynthesis.speak(speech);
}

function submit() {
  attempts++;

  const input = document.getElementById("answer").value.toLowerCase();

  // Bloqueia inglÃªs
  if (/[a-z]{3,}/.test(input) && !input.includes("Ã£") && !input.includes("Ã§")) {
    document.getElementById("feedback").innerText =
      "âŒ Traduza para um idioma que NÃƒO seja inglÃªs.";
    return;
  }

  if (questions[qIndex].pt.some(p => input.includes(p))) {
    hits++;
    qIndex++;

    if (qIndex >= questions.length && hits >= 2) {
      goExam();
      return;
    }

    loadQuestion();
  } else {
    document.getElementById("feedback").innerText = "âŒ Tente novamente.";

    // Texto aparece SOMENTE apÃ³s 3 tentativas
    if (attempts >= 3) {
      document.getElementById("questionText").classList.remove("hidden");
    }
  }
}

function goExam() {
  show("exam");
  document.getElementById("examQuestion").innerText = "Good night";
}

function sendExam() {
  const ans = document.getElementById("examAnswer").value.toLowerCase();

  if (ans.includes("boa noite")) {
    showResult(true);
  } else {
    showResult(false);
  }
}

function showResult(ok) {
  show("result");
  if (ok) {
    document.getElementById("resultTitle").innerText = "Aprovado ðŸŽ‰";
    document.getElementById("resultText").innerText =
      "VocÃª estÃ¡ pronto para a prÃ³xima fase.";
  } else {
    document.getElementById("resultTitle").innerText = "Reprovado";
    document.getElementById("resultText").innerText =
      "Treine mais e tente novamente.";
  }
}

function show(id) {
  document.querySelectorAll(".screen").forEach(s => s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}
</script>

</body>
</html>
