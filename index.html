<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Lalatina ‚Äî Fase 1</title>
<style>
body {
    font-family: Arial, sans-serif;
    background: #0e1621;
    color: #fff;
    margin: 0;
    padding: 0;
}
.container {
    max-width: 600px;
    margin: auto;
    padding: 20px;
}
.card {
    background: #1c2733;
    padding: 20px;
    border-radius: 12px;
}
.question-box {
    font-size: 22px;
    margin-bottom: 20px;
    min-height: 60px;
}
.answer-input {
    width: 100%;
    padding: 12px;
    font-size: 18px;
    border-radius: 8px;
    border: none;
}
.answer-input.correct { background: #2e7d32; color: #fff; }
.answer-input.wrong { background: #c62828; color: #fff; }

button {
    margin-top: 12px;
    padding: 12px;
    width: 100%;
    font-size: 18px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
}
button.primary { background: #2979ff; color: #fff; }
button.secondary { background: #455a64; color: #fff; }
.hidden { display: none; }

.progress {
    margin: 10px 0;
    font-size: 14px;
}

.explain-box {
    background: #263238;
    padding: 15px;
    border-radius: 10px;
    margin-top: 15px;
}
</style>
</head>

<body>
<div class="container">
    <div class="card">
        <div class="progress" id="progress"></div>

        <div class="question-box" id="questionText"></div>

        <input id="answerInput" class="answer-input" placeholder="Type your answer">

        <button class="primary" id="submitBtn">Answer</button>
        <button class="secondary hidden" id="nextBtn">Next Question</button>
        <button class="secondary hidden" id="skipBtn">Skip</button>

        <div class="explain-box hidden" id="explainBox">
            <p><b>Verb: TO BE</b></p>
            <p>I am = Eu sou / estou</p>
            <p>You are = Voc√™ √© / est√°</p>
            <p>He / She / It is = Ele / Ela / Isso √©</p>
            <p>We are = N√≥s somos</p>
            <p>They are = Eles s√£o</p>
            <button class="primary" id="speakBtn">üîä Ouvir explica√ß√£o</button>
            <button class="secondary hidden" id="pauseBtn">‚è∏ Pausar</button>
        </div>
    </div>
</div>

<script>
// ================= BANCO DE PERGUNTAS =================
const TOTAL_PHASE_QUESTIONS = 10000;
const MAX_PHASE_QUESTIONS = 500;

function getQuestion(index, difficulty) {
    // Banco FIXO, determin√≠stico
    if (difficulty >= 40 && difficulty <= 50) {
        return { q: "Complete: I ___ a student.", a: "am", verb: "to be" };
    }
    return { q: "Translate: Hello", a: "hello", verb: null };
}

// ================= ESTADO =================
let phaseProgress = 0.75; // come√ßa em 75% para facilitar teste
let difficulty = 75;
let askedQuestions = 0;
let attempts = 0;
let correctStreak = 0;
let readyForExam = false;

// ================= ELEMENTOS =================
const questionText = document.getElementById("questionText");
const answerInput = document.getElementById("answerInput");
const submitBtn = document.getElementById("submitBtn");
const nextBtn = document.getElementById("nextBtn");
const skipBtn = document.getElementById("skipBtn");
const progress = document.getElementById("progress");
const explainBox = document.getElementById("explainBox");
const speakBtn = document.getElementById("speakBtn");
const pauseBtn = document.getElementById("pauseBtn");

let currentQuestion;

// ================= FUN√á√ïES =================
function updateProgress() {
    progress.innerText = `Fase 1 ‚Äî Progresso: ${(phaseProgress*100).toFixed(0)}% | Dificuldade: ${difficulty}`;
}

function loadQuestion() {
    attempts = 0;
    answerInput.value = "";
    answerInput.className = "answer-input";
    nextBtn.classList.add("hidden");
    skipBtn.classList.add("hidden");
    explainBox.classList.add("hidden");

    currentQuestion = getQuestion(askedQuestions, difficulty);
    questionText.innerText = currentQuestion.q;

    // explica√ß√£o autom√°tica quando chega no verbo
    if (currentQuestion.verb === "to be") {
        explainBox.classList.remove("hidden");
    }

    askedQuestions++;
}

function checkAnswer() {
    attempts++;
    const userAnswer = answerInput.value.trim().toLowerCase();

    if (userAnswer === currentQuestion.a) {
        answerInput.classList.add("correct");
        correctStreak++;
        nextBtn.classList.remove("hidden");

        if (correctStreak >= 15 && difficulty >= 95) {
            readyForExam = true;
            startExam();
            return;
        }

        difficulty = Math.min(100, difficulty + 2);
        phaseProgress = Math.min(1, phaseProgress + 0.01);
    } else {
        answerInput.classList.add("wrong");
        correctStreak = 0;
        difficulty = Math.max(1, difficulty - 1);
        if (attempts >= 5) skipBtn.classList.remove("hidden");
    }
    updateProgress();
}

function nextQuestion() {
    loadQuestion();
}

function startExam() {
    alert("You are ready for the exam!");
    window.location.reload(); // simplifica√ß√£o visual
}

// ================= VOZ =================
let speech;
speakBtn.onclick = () => {
    speech = new SpeechSynthesisUtterance(explainBox.innerText);
    speech.lang = "pt-BR";
    speechSynthesis.speak(speech);
    pauseBtn.classList.remove("hidden");
};
pauseBtn.onclick = () => speechSynthesis.pause();

// ================= EVENTOS =================
submitBtn.onclick = checkAnswer;
nextBtn.onclick = nextQuestion;
skipBtn.onclick = nextQuestion;

// ================= INICIAR =================
updateProgress();
loadQuestion();
</script>
</body>
</html>
