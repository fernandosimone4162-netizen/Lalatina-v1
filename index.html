<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Lalatina â€” Fase 1</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    background:#0e0e10;
    color:#fff;
    font-family:Arial, sans-serif;
    padding:20px;
}
h1 { text-align:center; color:#ff69b4; }
.box {
    background:#1c1c1f;
    padding:20px;
    border-radius:10px;
    margin-bottom:15px;
}
button {
    width:100%;
    padding:15px;
    margin-top:10px;
    border:none;
    border-radius:8px;
    background:#ff69b4;
    font-size:16px;
    cursor:pointer;
}
button:hover { opacity:0.9; }
input {
    width:100%;
    padding:12px;
    border-radius:8px;
    border:none;
    margin-top:10px;
}
select {
    width:100%;
    padding:12px;
    border-radius:8px;
    margin-top:10px;
}
.info {
    text-align:center;
    opacity:0.7;
    font-size:14px;
}
.hidden { display:none; }
</style>
</head>

<body>

<h1>Lalatina â€” Fase 1</h1>

<!-- TELA IDIOMA -->
<div class="box" id="languageScreen">
    <h3>Escolha seu idioma</h3>
    <select id="userLanguage">
        <option value="pt-BR">PortuguÃªs (Brasil)</option>
        <option value="es-ES">Espanhol</option>
        <option value="it-IT">Italiano</option>
        <option value="fr-FR">FrancÃªs</option>
        <option value="ja-JP">JaponÃªs</option>
        <option value="ko-KR">Coreano</option>
        <option value="zh-CN">Mandarim</option>
        <option value="en-US">InglÃªs</option>
    </select>
    <button onclick="start()">ComeÃ§ar</button>
</div>

<!-- JOGO -->
<div class="box hidden" id="gameScreen">
    <div id="questionBox">Carregando...</div>

    <input id="answerInput" placeholder="Digite a traduÃ§Ã£o aqui">

    <button onclick="startVoice()">ðŸŽ¤ Responder por voz</button>
    <button onclick="submitAnswer()">Responder</button>

    <div class="info" id="info"></div>
</div>

<script>
/* =========================
   CONFIGURAÃ‡ÃƒO
========================= */

let difficulty = 1;
let questionCount = 0;
let difficultyBlock = 0;
let audioPlays = 0;
let userLang = "pt-BR";
let currentSentence = "";

/* =========================
   BANCO (EXEMPLOS REAIS)
========================= */

const BANK = {
1: [
 "Hello.",
 "Good morning.",
 "How are you?",
 "Nice to meet you.",
 "Thank you."
],
2: [
 "How old are you?",
 "Where do you live?",
 "I like coffee.",
 "She is my friend.",
 "I work every day."
],
3: [
 "I am learning English.",
 "This is very important.",
 "Can you help me?",
 "I need more time.",
 "I understand you."
],
4: [
 "I have been studying all morning.",
 "This situation is complicated.",
 "She didn't understand the question.",
 "We need to solve this problem.",
 "He is trying his best."
],
5: [
 "If I had known, I would have acted differently.",
 "She has been working here for years.",
 "This decision could change everything.",
 "Understanding takes time and patience.",
 "He realized the mistake too late."
]
};

/* =========================
   INICIALIZAÃ‡ÃƒO
========================= */

function start() {
    userLang = document.getElementById("userLanguage").value;
    document.getElementById("languageScreen").classList.add("hidden");
    document.getElementById("gameScreen").classList.remove("hidden");
    nextQuestion();
}

/* =========================
   GERADOR DE PERGUNTAS
========================= */

function nextQuestion() {
    audioPlays = 0;
    questionCount++;

    if (questionCount % 5 === 0) difficultyBlock++;

    difficulty = Math.min(5, Math.max(1, difficulty));

    const list = BANK[difficulty];
    currentSentence = list[Math.floor(Math.random() * list.length)];

    document.getElementById("questionBox").innerText =
        "ðŸ”Š OuÃ§a atentamente...";
    document.getElementById("info").innerText =
        `Pergunta ${questionCount} | Dificuldade ${difficulty}`;

    playAudio();
}

/* =========================
   ÃUDIO (3x)
========================= */

function playAudio() {
    if (audioPlays >= 3) {
        document.getElementById("questionBox").innerText =
            `Traduza: "${currentSentence}"`;
        return;
    }

    audioPlays++;
    const utter = new SpeechSynthesisUtterance(currentSentence);
    utter.lang = "en-US";
    speechSynthesis.speak(utter);

    utter.onend = () => {
        setTimeout(playAudio, 600);
    };
}

/* =========================
   RESPOSTA
========================= */

function submitAnswer() {
    const input = document.getElementById("answerInput");
    const answer = input.value.trim();
    input.value = "";

    if (answer.length === 0) return;

    // Ajuste simples adaptativo
    if (answer.length < 3) difficulty--;
    else difficulty++;

    nextQuestion();
}

/* =========================
   VOZ DO USUÃRIO
========================= */

function startVoice() {
    if (!('webkitSpeechRecognition' in window)) {
        alert("Reconhecimento de voz nÃ£o suportado.");
        return;
    }

    const rec = new webkitSpeechRecognition();
    rec.lang = userLang;
    rec.start();

    rec.onresult = (e) => {
        document.getElementById("answerInput").value =
            e.results[0][0].transcript;
    };
}
</script>

</body>
</html>
