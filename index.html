<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lalatina â€” Fase 1</title>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    color: white;
    background: radial-gradient(circle at top, #3a0a6a, #12001f 70%);
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
}

.app {
    width: 100%;
    max-width: 420px;
    padding: 20px;
}

.card {
    background: rgba(0,0,0,0.55);
    border-radius: 16px;
    padding: 20px;
    text-align: center;
}

h1 {
    margin-top: 0;
    font-size: 22px;
}

select, input {
    width: 100%;
    padding: 12px;
    border-radius: 10px;
    border: none;
    font-size: 16px;
    margin-top: 10px;
}

button {
    width: 100%;
    margin-top: 12px;
    padding: 14px;
    border-radius: 12px;
    border: none;
    background: black;
    color: white;
    font-size: 16px;
    cursor: pointer;
}

button:hover {
    opacity: 0.85;
}

.hidden {
    display: none;
}

.feedback {
    margin-top: 10px;
    font-size: 15px;
}

.question-text {
    font-size: 22px;
    margin-bottom: 10px;
    display: none;
}
</style>
</head>

<body>

<div class="app">

<!-- TELA DE IDIOMA -->
<div class="card" id="languageScreen">
    <h1>Escolha seu idioma</h1>
    <select id="userLang">
        <option value="pt-BR">PortuguÃªs</option>
        <option value="it-IT">Italiano</option>
        <option value="es-ES">Espanhol</option>
        <option value="fr-FR">FrancÃªs</option>
        <option value="ja-JP">JaponÃªs</option>
        <option value="ko-KR">Coreano</option>
        <option value="zh-CN">Mandarim</option>
        <option value="en-US">InglÃªs</option>
    </select>
    <button onclick="startApp()">ComeÃ§ar</button>
</div>

<!-- FASE 1 -->
<div class="card hidden" id="gameScreen">

    <h1>Fase 1</h1>

    <div id="questionText" class="question-text"></div>

    <input id="answer" placeholder="Digite a traduÃ§Ã£o">

    <button onclick="playAudio()">ðŸ”Š Escutar novamente</button>
    <button onclick="startVoice()">ðŸŽ¤ Responder por voz</button>
    <button onclick="submitAnswer()">Enviar / PrÃ³xima</button>

    <div class="feedback" id="feedback"></div>

</div>

</div>

<script>
/* =============================
   CONFIGURAÃ‡ÃƒO INICIAL
============================= */
let userLanguage = "pt-BR";
let attempts = 0;
let questionCount = 0;
let difficulty = 1;
let currentQuestion = "";
let totalQuestions = Math.floor(Math.random() * (300 - 150 + 1)) + 150;

/* =============================
   BANCO SIMPLIFICADO (FASE 1)
   (estrutura pronta para crescer)
============================= */
const BANK = {
    1: ["hello", "yes", "no", "hi", "good morning", "good night"],
    2: ["thank you", "please", "sorry", "good afternoon"],
    3: ["how are you", "are you ok"],
    4: ["i am fine", "i am ok"],
    5: ["you are ok", "i am here"]
};

/* =============================
   CONTROLE DE TELAS
============================= */
function startApp() {
    userLanguage = document.getElementById("userLang").value;
    document.getElementById("languageScreen").classList.add("hidden");
    document.getElementById("gameScreen").classList.remove("hidden");
    nextQuestion();
}

/* =============================
   GERAR PERGUNTA
============================= */
function nextQuestion() {
    attempts = 0;
    document.getElementById("answer").value = "";
    document.getElementById("feedback").innerText = "";
    document.getElementById("questionText").style.display = "none";

    // dificuldade sobe lentamente a cada 5 perguntas
    if (questionCount > 0 && questionCount % 5 === 0 && difficulty < 5) {
        difficulty++;
    }

    let pool = BANK[difficulty] || BANK[1];
    currentQuestion = pool[Math.floor(Math.random() * pool.length)];
    questionCount++;

    playAudio();
}

/* =============================
   ÃUDIO
============================= */
function playAudio() {
    let speech = new SpeechSynthesisUtterance(currentQuestion);
    speech.lang = "en-US";
    speechSynthesis.speak(speech);
}

/* =============================
   RESPOSTA
============================= */
function submitAnswer() {
    attempts++;

    if (attempts >= 3) {
        document.getElementById("questionText").innerText = currentQuestion;
        document.getElementById("questionText").style.display = "block";
    }

    document.getElementById("feedback").innerText =
        "âœ”ï¸ Resposta registrada";

    // ajuste adaptativo simples
    if (attempts >= 4 && difficulty > 1) {
        difficulty--;
    }

    if (questionCount >= totalQuestions) {
        alert("Fase concluÃ­da. O algoritmo irÃ¡ avaliar vocÃª.");
        return;
    }

    nextQuestion();
}

/* =============================
   VOZ
============================= */
function startVoice() {
    if (!('webkitSpeechRecognition' in window)) {
        alert("Reconhecimento de voz nÃ£o suportado");
        return;
    }

    let rec = new webkitSpeechRecognition();
    rec.lang = userLanguage;
    rec.start();

    rec.onresult = e => {
        document.getElementById("answer").value =
            e.results[0][0].transcript;
    };
}
</script>

</body>
</html>
